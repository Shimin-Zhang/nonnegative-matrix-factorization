{"version":3,"file":"three-spritetext.js","sources":["../src/index.js"],"sourcesContent":["export default class extends THREE.Sprite {\n  constructor(text = '', textHeight = 10, color = 'rgba(255, 255, 255, 1)') {\n    super(new THREE.SpriteMaterial({ map: new THREE.Texture() }));\n\n    this._text = text;\n    this._textHeight = textHeight;\n    this._color = color;\n\n    this._fontFace = 'Arial';\n    this._fontSize = 90; // defines text resolution\n\n    this._canvas = document.createElement('canvas');\n    this._texture = this.material.map;\n    this._texture.minFilter = THREE.LinearFilter;\n\n    this._genCanvas();\n  }\n\n  get text() { return this._text; }\n  set text(text) { this._text = text; this._genCanvas(); }\n  get textHeight() { return this._textHeight; }\n  set textHeight(textHeight) { this._textHeight = textHeight; this._genCanvas(); }\n  get color() { return this._color; }\n  set color(color) { this._color = color; this._genCanvas(); }\n  get fontFace() { return this._fontFace; }\n  set fontFace(fontFace) { this._fontFace = fontFace; this._genCanvas(); }\n  get fontSize() { return this._fontSize; }\n  set fontSize(fontSize) { this._fontSize = fontSize; this._genCanvas(); }\n\n  _genCanvas() {\n    const canvas = this._canvas;\n    const ctx = canvas.getContext('2d');\n\n    const font = `normal ${this.fontSize}px ${this.fontFace}`;\n\n    ctx.font = font;\n    const textWidth = ctx.measureText(this.text).width;\n    canvas.width = textWidth;\n    canvas.height = this.fontSize;\n\n    ctx.font = font;\n    ctx.fillStyle = this.color;\n    ctx.textBaseline = 'bottom';\n    ctx.fillText(this.text, 0, canvas.height);\n\n    // Inject canvas into sprite\n    this._texture.image = canvas;\n    this._texture.needsUpdate = true;\n\n    this.scale.set(this.textHeight * canvas.width / canvas.height, this.textHeight);\n  }\n\n  clone() {\n    return new this.constructor(this.text, this.textHeight, this.color).copy(this);\n  }\n\n  copy(source) {\n    THREE.Sprite.prototype.copy.call(this, source);\n\n    this.color = source.color;\n    this.fontFace = source.fontFace;\n    this.fontSize = source.fontSize;\n\n    return this;\n  }\n}"],"names":["text","textHeight","color","THREE","SpriteMaterial","map","Texture","_text","_textHeight","_color","_fontFace","_fontSize","_canvas","document","createElement","_texture","material","minFilter","LinearFilter","_genCanvas","canvas","ctx","getContext","font","fontSize","fontFace","textWidth","measureText","width","height","fillStyle","textBaseline","fillText","image","needsUpdate","scale","set","constructor","copy","source","Sprite","prototype","call"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAC4E;QAA9DA,IAA8D,uEAAvD,EAAuD;QAAnDC,UAAmD,uEAAtC,EAAsC;QAAlCC,KAAkC,uEAA1B,wBAA0B;;;+GAClE,IAAIC,MAAMC,cAAV,CAAyB,EAAEC,KAAK,IAAIF,MAAMG,OAAV,EAAP,EAAzB,CADkE;;UAGnEC,KAAL,GAAaP,IAAb;UACKQ,WAAL,GAAmBP,UAAnB;UACKQ,MAAL,GAAcP,KAAd;;UAEKQ,SAAL,GAAiB,OAAjB;UACKC,SAAL,GAAiB,EAAjB,CARwE;;UAUnEC,OAAL,GAAeC,SAASC,aAAT,CAAuB,QAAvB,CAAf;UACKC,QAAL,GAAgB,MAAKC,QAAL,CAAcX,GAA9B;UACKU,QAAL,CAAcE,SAAd,GAA0Bd,MAAMe,YAAhC;;UAEKC,UAAL;;;;;;iCAcW;UACLC,SAAS,KAAKR,OAApB;UACMS,MAAMD,OAAOE,UAAP,CAAkB,IAAlB,CAAZ;;UAEMC,mBAAiB,KAAKC,QAAtB,WAAoC,KAAKC,QAA/C;;UAEIF,IAAJ,GAAWA,IAAX;UACMG,YAAYL,IAAIM,WAAJ,CAAgB,KAAK3B,IAArB,EAA2B4B,KAA7C;aACOA,KAAP,GAAeF,SAAf;aACOG,MAAP,GAAgB,KAAKL,QAArB;;UAEID,IAAJ,GAAWA,IAAX;UACIO,SAAJ,GAAgB,KAAK5B,KAArB;UACI6B,YAAJ,GAAmB,QAAnB;UACIC,QAAJ,CAAa,KAAKhC,IAAlB,EAAwB,CAAxB,EAA2BoB,OAAOS,MAAlC;;;WAGKd,QAAL,CAAckB,KAAd,GAAsBb,MAAtB;WACKL,QAAL,CAAcmB,WAAd,GAA4B,IAA5B;;WAEKC,KAAL,CAAWC,GAAX,CAAe,KAAKnC,UAAL,GAAkBmB,OAAOQ,KAAzB,GAAiCR,OAAOS,MAAvD,EAA+D,KAAK5B,UAApE;;;;4BAGM;aACC,IAAI,KAAKoC,WAAT,CAAqB,KAAKrC,IAA1B,EAAgC,KAAKC,UAArC,EAAiD,KAAKC,KAAtD,EAA6DoC,IAA7D,CAAkE,IAAlE,CAAP;;;;yBAGGC,QAAQ;YACLC,MAAN,CAAaC,SAAb,CAAuBH,IAAvB,CAA4BI,IAA5B,CAAiC,IAAjC,EAAuCH,MAAvC;;WAEKrC,KAAL,GAAaqC,OAAOrC,KAApB;WACKuB,QAAL,GAAgBc,OAAOd,QAAvB;WACKD,QAAL,GAAgBe,OAAOf,QAAvB;;aAEO,IAAP;;;;2BA7CS;aAAS,KAAKjB,KAAZ;;yBACJP,MAAM;WAAOO,KAAL,GAAaP,IAAb,CAAmB,KAAKmB,UAAL;;;;2BACnB;aAAS,KAAKX,WAAZ;;yBACJP,YAAY;WAAOO,WAAL,GAAmBP,UAAnB,CAA+B,KAAKkB,UAAL;;;;2BAChD;aAAS,KAAKV,MAAZ;;yBACJP,OAAO;WAAOO,MAAL,GAAcP,KAAd,CAAqB,KAAKiB,UAAL;;;;2BACzB;aAAS,KAAKT,SAAZ;;yBACJe,UAAU;WAAOf,SAAL,GAAiBe,QAAjB,CAA2B,KAAKN,UAAL;;;;2BACrC;aAAS,KAAKR,SAAZ;;yBACJa,UAAU;WAAOb,SAAL,GAAiBa,QAAjB,CAA2B,KAAKL,UAAL;;;;EA3BzBhB,MAAMqC;;;;;;;;"}